a)
create table Studio( 
	Name varchar(20),
	Address varchar(10),
	Phone varchar(10),
	primary key(Name));

create table Producer( 
	Num varchar(2),
	Name varchar(10),
	Gender varchar(1),
	Address varchar(3),
	primary key(Num));

create table Star( 
	Name varchar(20),
	Age numeric(2,0),
	Gender char(1),
	primary key(Name));

create table Movie( 
	Title varchar(10),
	Year numeric(4,0),
	Length numeric(3,0),
	Studio_Name varchar(20),
	Producer_Num varchar(2),
	Primary key(Title,Year),
	Foreign key (Studio_Name) references Studio(Name),
	Foreign key (Producer_Num) references Producer(Num));

create table Starln( 
	Movie_Title varchar(10),
	Movie_Year numeric(4,0),
	Star_Name varchar(20),
	primary key(Movie_Title,Movie_Year,Star_Name),
	Foreign key (Star_Name) references Star(Name),
	Foreign key (Movie_Title,Movie_Year) references Movie(Title,Year));


insert into Studio values('SM Studio','Korea','111-1234');
insert into Studio values('Disney Studio','USA','222-1234');
insert into Studio values('Fox Studio','USA','333-1234');

insert into Producer values('P1','Lucas','M','USA');
insert into Producer values('P2','Spielberg','M','USA');
insert into Producer values('P3','Lucas','F','USA');
insert into Producer values('P4','Jennifer','F','USA');

insert into Star values('Robert Downey',48,'M');
insert into Star values('Chris Evans',60,'M');
insert into Star values('Brad Pitt ',48,'M');
insert into Star values('Angelina Jolie',48,'F');
insert into Star values('Elsa',null,'F');
insert into Star values('Anna',null,'F');
insert into Star values('Jennifer',45,'F');

insert into Movie values('Star Wars',1977,95,'Fox Studio','P1');
insert into Movie values('Star Wars',2010,130,'Fox Studio','P1');
insert into Movie values('Star Wars',2017,120,'Fox Studio','P2');
insert into Movie values('Moana',1990,110,'Disney Studio','P2');
insert into Movie values('Lion King',1990,120,'Disney Studio','P3');
insert into Movie values('Lion King',1995,120,'Disney Studio','P4');
insert into Movie values('Frozen',2013,109,'SM Studio','P4');
insert into Movie values('Frozen',2015,109,'SM Studio','P1');

insert into Starln values('Star Wars',1977,'Robert Downey');
insert into Starln values('Star Wars',1977,'Chris Evans');
insert into Starln values('Star Wars',2010,'Robert Downey');
insert into Starln values('Star Wars',2010,'Chris Evans');
insert into Starln values('Star Wars',2010,'Angelina Jolie');
insert into Starln values('Star Wars',2017,'Elsa');
insert into Starln values('Frozen',2013,'Elsa');
insert into Starln values('Frozen',2015,'Anna');

b)
select Title
from Movie
Where Length>115;

c) 
select name,address
from movie,producer
where movie.producer_num=producer.num and year = 1990 and studio_name ='Disney Studio';

d)
select name
from star
where age is null;

e)
select distinct name
from star,starln
where star.name = starln.star_name and movie_title='Star Wars'
order by age desc,name;

f)
select name,count(title) as num_movie
from movie,studio
where movie.studio_name = studio.name
group by movie.studio_name;

g)
select name,address,phone, (select count(*)
			from movie
			where studio.name = movie.studio_name) 
			as num_movie
from studio;


h)
select name,sum(length)
from movie,producer
where movie.producer_num = producer.num
group by num
having count(title)>1;


i)
select name,sum_length
from (select sum(length) as sum_length, name, count(title) as count_movie
	from movie,producer
	where movie.producer_num = producer.num
	group by num) as m1
where m1.count_movie>1;













